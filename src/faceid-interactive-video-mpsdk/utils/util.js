const regeneratorRuntime=require("./regenerator-runtime/runtime");function compareVersion(e,r){e=e.split("."),r=r.split(".");for(var t=Math.max(e.length,r.length);e.length<t;)e.push("0");for(;r.length<t;)r.push("0");for(var o=0;o<t;o++){var s=parseInt(e[o]),a=parseInt(r[o]);if(s>a)return 1;if(s<a)return-1}return 0}const requestPromise=function(e){const{url:r,method:t="POST",data:o,header:s={"Content-Type":"application/json"}}=e;return console.log("requestPromise start:",r,o),new Promise((e,a)=>{wx.request({url:r,method:t,data:o,header:s,timeout:5e3,success(r){console.log("requestPromise success:",r),e(r)},fail(e){console.log("requestPromise error:",e),a(e)}})})},request=function(e,r){const{url:t,method:o="POST",data:s,header:a={"Content-Type":"application/json"}}=e;console.log("requestPromise start:",t,s);try{wx.request({url:t,method:o,data:s,header:a,success(e){console.log("request success:",e),200===e.statusCode&&e.data?0===e.data.ErrorCode?r({ErrorCode:0,Data:e.data.Data}):r({ErrorCode:e.data.ErrorCode,ErrorMsg:e.data.ErrorMsg,Data:e.data.Data}):r({ErrorCode:-107,ErrorMsg:"request请求异常，请稍后重试"})},fail(e){console.log("request error:",e),e.errMsg.indexOf("request:fail Unable to resolve host")>=0||e.errMsg.indexOf("request:fail 似乎已断开与互联网的连接")>=0?r({ErrorCode:101,ErrorMsg:"网络异常，请稍后重试"}):r({ErrorCode:-107,ErrorMsg:"request请求异常，请稍后重试"})}})}catch(e){console.log("request error:",e),r({ErrorCode:-107,ErrorMsg:"request请求异常"})}},validate=function(e,r){switch(r){case"idcard":return IDNumberValid(e);case"idname":return!e.match(/[A-z0-9]/g);case"end_path":return/^\//.test(e);case"BizToken":return/^[a-zA-Z0-9-]{36}$/.test(e)}},showModal=function(e,r){wx.showModal({title:e,content:r.replace(/(^\s*)|(\s*$)/g,""),showCancel:!1,confirmText:"我知道了",confirmColor:"#2d72f1",success:function(e){e.confirm||e.cancel}})},IDNumberValid=function(e){if(!e||!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))return!1;if(!{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"}[e.substr(0,2)])return!1;if(18===e.length){e=e.split("");const r=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],t=[1,0,"X",9,8,7,6,5,4,3,2];let o=0,s=0,a=0;for(let t=0;t<17;t++)o+=(s=e[t])*(a=r[t]);const n=t[o%11];if("x"===e[17]||"X"===e[17])return n===e[17].toUpperCase();if(n!==parseInt(e[17]))return!1}return!0};module.exports={requestPromise:requestPromise,validate:validate,compareVersion:compareVersion,showModal:showModal,request:request};